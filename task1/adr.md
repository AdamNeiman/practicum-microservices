### <a name="_b7urdng99y53"></a>**Название задачи:** Архитектурные варианты MVP мониторинга свиноводческой фермы
### <a name="_hjk0fkfyohdk"></a>**Автор:** Штокало Андрей
### <a name="_uanumrh8zrui"></a>**Дата:** 27 июля 2025

---
### <a name="_3bfxc9a45514"></a>**Функциональные требования**
|  №  | Действующие лица или системы | Use Case                                 | Описание                                                             |
| :-: | :--------------------------- | :--------------------------------------- | :------------------------------------------------------------------- |
|  1  | Оператор фермы               | Получить оповещение о нештатной ситуации | Система фиксирует тревожное поведение или драку, оповещает оператора |
|  2  | Система мониторинга          | Анализировать видеопоток                 | Аналитика определяет болезнь, гибель, беспокойство, задавливание     |
|  3  | Агенты (edge-устройства)     | Управлять кормушками/поилками            | Отправка команд на устройства разных производителей                  |
|  4  | Система учета                | Пересчитать поголовье                    | Система периодически или по запросу пересчитывает животных           |
|  5  | Оператор фермы               | Получить метрики состояния систем        | Оценка состояния фильтрации воды, кормовых запасов, прогнозы расхода |
|  6  | Мобильное/веб-приложение     | Интеграция через API                     | Возможность построения мобильных и веб-приложений                    |

---
### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**
|  №  | Требование                                                            |
| :-: | :-------------------------------------------------------------------- |
|  1  | Отказоустойчивость 99,95%                                             |
|  2  | Реагирование системы видеоаналитики в реальном времени (миллисекунды) |
|  3  | Отправка оповещения оператору за ≤ 5 секунд после события             |
|  4  | Расширяемость, возможность добавления метрик и функционала без ломки  |
|  5  | Работа в условиях плохого интернета, офлайн-режим                     |
|  6  | Современная аутентификация и авторизация                              |
|  7  | API для интеграции и приложений                                       |

---

### <a name="_qmphm5d6rvi3"></a>**Решение**

#### Контекстная диаграмма — Основной вариант

[Диаграмма C1 - основной вариант](./C1_main.puml)


#### Краткое описание логики выбора

* Центральный сервер агрегирует аналитику, тревоги и метрики с агентов (ферм).
* Edge-агенты на фермах обеспечивают автономную работу и видеоаналитику на месте.
* Метрики отправляются в ERP/учётную систему.
* Оповещения идут напрямую от агента оператору (мин. задержка), а при восстановлении связи — синхронизация с центральной системой.
* Расширяемость и отказоустойчивость достигаются за счёт архитектуры "центральный сервер — агенты".

---

### <a name="_bjrr7veeh80c"></a>**Альтернативы**

#### Контекстная диаграмма — Альтернативный вариант

[Диаграмма C1 - альтернативный вариант](./C1_alt.puml)

#### Краткое описание логики выбора

* Вся видеоаналитика и управление — только на центральном сервере.
* Edge-агенты отсутствуют, ферма просто поставщик видеопотоков и данных.
* Оповещения отправляет центральный сервер.
* Проще масштабировать центр, но выше требования к каналам связи и центральному серверу.

---

### Недостатки, ограничения, риски

**Основной вариант:**

* Требует разработки ПО для edge-агентов, но обеспечивает офлайн-работу.
* Сложнее поддерживать обновления агентов.
* Возможны задержки в синхронизации (до 10 мин), если связь прерывается.

**Альтернативный вариант:**

* Не работает при плохом интернете (нет офлайн-функций).
* Вся нагрузка — на центральный сервер.
* Больше рисков при сбоях централизованной системы.
